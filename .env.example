# Runtime identity
RUSTY_PINCH_PROVIDER=codex
RUSTY_PINCH_MODEL=gpt-5.2-codex
RUSTY_PINCH_REQUEST_TIMEOUT_SECS=60
RUSTY_PINCH_REQUEST_RETRIES=2
RUSTY_PINCH_RETRY_BACKOFF_MS=600
RUSTY_PINCH_RETRY_MAX_BACKOFF_MS=4000

# Paths
RUSTY_PINCH_DATA_DIR=./data
RUSTY_PINCH_WORKSPACE=./workspace
# RUSTY_PINCH_TELEMETRY_FILE=./data/telemetry/latest.json

# Queue behavior
RUSTY_PINCH_BUS_CAPACITY=100
RUSTY_PINCH_BUS_OVERFLOW=drop_oldest

# API keys (choose based on provider)
# RUSTY_PINCH_OPENROUTER_API_KEY=
# RUSTY_PINCH_OPENAI_API_KEY=

# API base (optional, defaults per provider)
# RUSTY_PINCH_OPENROUTER_API_BASE=https://openrouter.ai/api/v1
# RUSTY_PINCH_OPENAI_API_BASE=https://api.openai.com/v1

# Telegram channel (long polling)
RUSTY_PINCH_CHANNELS_TELEGRAM_ENABLED=false
# RUSTY_PINCH_CHANNELS_TELEGRAM_TOKEN=123456:telegram-bot-token
# RUSTY_PINCH_CHANNELS_TELEGRAM_ALLOW_FROM=12345678,87654321
RUSTY_PINCH_CHANNELS_TELEGRAM_POLL_TIMEOUT_SECS=30
RUSTY_PINCH_CHANNELS_TELEGRAM_POLL_INTERVAL_MS=350
RUSTY_PINCH_CHANNELS_TELEGRAM_REQUEST_TIMEOUT_SECS=60

# WhatsApp channel (bridge websocket)
RUSTY_PINCH_CHANNELS_WHATSAPP_ENABLED=false
# RUSTY_PINCH_CHANNELS_WHATSAPP_BRIDGE_URL=ws://localhost:3001
# RUSTY_PINCH_CHANNELS_WHATSAPP_ALLOW_FROM=phone-or-user-id
RUSTY_PINCH_CHANNELS_WHATSAPP_RECONNECT_MS=2000

# Codex CLI integration (brain)
RUSTY_PINCH_CODEX_ENABLED=true
RUSTY_PINCH_CODEX_CLI_BIN=codex
# Default Codex CLI invocation is `codex exec --skip-git-repo-check <prompt>`.
# `--skip-git-repo-check` avoids failures when runtime working dir is not a git repo (e.g. containerized workers).
# Override if your codex-compatible CLI uses a different non-interactive subcommand.
RUSTY_PINCH_CODEX_CLI_ARGS="exec --skip-git-repo-check"
# Leave blank for positional prompt argument.
RUSTY_PINCH_CODEX_PROMPT_FLAG=
RUSTY_PINCH_CODEX_MODEL_FLAG=--model
RUSTY_PINCH_CODEX_TIMEOUT_SECS=120
RUSTY_PINCH_CODEX_QUEUE_CAPACITY=256
RUSTY_PINCH_CODEX_RATE_LIMIT_THRESHOLD_PERCENT=25
RUSTY_PINCH_CODEX_RATE_WINDOW_SECS=3600
RUSTY_PINCH_CODEX_HEALTHCHECK_INTERVAL_SECS=300
RUSTY_PINCH_CODEX_HEALTHCHECK_ARGS=--version
# RUSTY_PINCH_CODEX_MODEL=gpt-5-codex
# Account format: id|api_key_env|max_requests|model ; ...
# RUSTY_PINCH_CODEX_ACCOUNTS=primary|OPENAI_API_KEY|200|gpt-5-codex;backup|RUSTY_PINCH_OPENROUTER_API_KEY|200|openrouter/qwen/qwen3-coder
# Container/login bootstrap options
RUSTY_PINCH_CODEX_AUTO_LOGIN=true
# chatgpt | api-key | off
RUSTY_PINCH_CODEX_AUTO_LOGIN_MODE=chatgpt
RUSTY_PINCH_CODEX_CHATGPT_DEVICE_AUTH=true
RUSTY_PINCH_CODEX_LOGIN_TIMEOUT_SECS=300
# Optional pre-seeded ChatGPT auth material:
# RUSTY_PINCH_CODEX_CHATGPT_AUTH_FILE=/run/secrets/codex-auth.json
# RUSTY_PINCH_CODEX_CHATGPT_AUTH_JSON_B64=<base64-auth-json>
# Optional API key source env (default: RUSTY_PINCH_OPENAI_API_KEY)
# RUSTY_PINCH_CODEX_AUTO_LOGIN_API_KEY_ENV=RUSTY_PINCH_OPENAI_API_KEY

# Pulse approval policy
# Matched action keywords bypass human approval in OODA.
# Use '*' to auto-allow everything.
RUSTY_PINCH_PULSE_AUTO_ALLOW_ACTIONS=deploy,restart,email,purchase,self-update

# Evolution safety policy
# Require --confirm for "evolution apply-staged-update" by default.
RUSTY_PINCH_EVOLUTION_REQUIRE_APPLY_CONFIRM=true
# Require --artifact-sha256 for "evolution stage-update" by default.
RUSTY_PINCH_EVOLUTION_REQUIRE_STAGE_ARTIFACT_SHA256=false
# Require non-rollback version checks (`--current-version` + `--artifact-version`) for stage/apply.
RUSTY_PINCH_EVOLUTION_REQUIRE_NON_ROLLBACK_VERSION=false
# Require apply-time checksum provenance anchored to signed SHA256SUMS metadata.
RUSTY_PINCH_EVOLUTION_REQUIRE_SIGNED_CHECKSUM_MANIFEST_PROVENANCE=false
# Optional trusted checksum-manifest hash pin for --artifact-sha256-sums-file.
# RUSTY_PINCH_EVOLUTION_TRUSTED_SHA256SUMS_SHA256=<sha256-of-sha256sums-file>
# Optional trusted Ed25519 public key for checksum-manifest detached signature verification.
# Accepts 64-char hex or base64-encoded 32-byte key.
# RUSTY_PINCH_EVOLUTION_TRUSTED_SHA256SUMS_ED25519_PUBLIC_KEY=<ed25519-public-key>
# Require detached signature verification when using --artifact-sha256-sums-file.
RUSTY_PINCH_EVOLUTION_REQUIRE_SHA256SUMS_SIGNATURE=false
# Require apply-time manifest provenance to come from a checksum-verified stage.
RUSTY_PINCH_EVOLUTION_REQUIRE_VERIFIED_STAGE_ARTIFACT_SHA256=false
# Optional HMAC key for staged manifest signing/verification.
# RUSTY_PINCH_EVOLUTION_MANIFEST_SIGNING_KEY=change-me-to-a-long-random-secret
# Optional key id for active signing key (default: "default" when key is set).
# RUSTY_PINCH_EVOLUTION_MANIFEST_SIGNING_KEY_ID=2026-q1
# Optional verification keyring for signature rotation (format: id|key;id|key).
# RUSTY_PINCH_EVOLUTION_MANIFEST_SIGNING_KEYS=2025-q4|old-secret;2026-q1|new-secret
# Enforce manifest signature verification before apply.
RUSTY_PINCH_EVOLUTION_REQUIRE_MANIFEST_SIGNATURE=false
# Optional HMAC key used to sign/verify `${RUSTY_PINCH_WORKSPACE}/updates/active-slot`.
# RUSTY_PINCH_EVOLUTION_ACTIVE_SLOT_SIGNING_KEY=change-me-to-a-long-random-secret
# Optional key id for active-slot signature metadata (default: manifest key id / "default").
# RUSTY_PINCH_EVOLUTION_ACTIVE_SLOT_SIGNING_KEY_ID=2026-q1
# Enforce signed active-slot marker verification during stage/apply.
RUSTY_PINCH_EVOLUTION_REQUIRE_SIGNED_ACTIVE_SLOT=false
# Maximum allowed age (seconds) for staged manifests at apply time (0 disables freshness guard).
RUSTY_PINCH_EVOLUTION_MAX_STAGED_MANIFEST_AGE_SECS=86400
# Open apply failure circuit after this many consecutive failed apply attempts (0 disables circuit breaker).
RUSTY_PINCH_EVOLUTION_MAX_CONSECUTIVE_APPLY_FAILURES=3
# Consider lock stale after this many seconds (0 disables stale detection).
RUSTY_PINCH_EVOLUTION_LOCK_STALE_AFTER_SECS=900
# Auto-recover stale lock by removing it before stage/apply.
RUSTY_PINCH_EVOLUTION_AUTO_RECOVER_STALE_LOCK=true
